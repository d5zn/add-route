<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="description" content="addicted - Web application for addicted project">
    <meta name="keywords" content="addicted, web, application, mobile, responsive">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>addicted</title>
    <link rel="icon" type="image/svg+xml" href="/route/favicon.svg?v=1">
    <link rel="icon" type="image/x-icon" href="/route/favicon.ico?v=1">
    <link rel="shortcut icon" href="/route/favicon.ico?v=1">
    <link rel="apple-touch-icon" href="/route/favicon.ico?v=1">
    <link rel="stylesheet" href="/route/styles-addicted.css?v=25">
</head>
<body>
    <div class="mobile-container" id="mobile-container">
        <!-- Navigation Bar -->
        <nav class="navbar">
            <div class="nav-container">
                <div class="nav-brand">
                    <span class="nav-logo-text">addicted</span>
                </div>
                <div class="nav-center">
                    <button class="nav-btn" title="Select Club" id="club-selector-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-users">
                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                            <circle cx="9" cy="7" r="4"></circle>
                            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                        </svg>
                    </button>
                    <button class="nav-btn" title="Select Workout" id="workout-selector-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-activity">
                            <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
                        </svg>
                    </button>
                    <button class="nav-btn" title="Download" id="share-btn">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="7,10 12,15 17,10"/>
                            <line x1="12" y1="15" x2="12" y2="3"/>
                        </svg>
                    </button>
                </div>
                <div class="nav-actions">
                    <button class="nav-btn" title="Logout" id="logout-btn">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
                            <polyline points="16,17 21,12 16,7"/>
                            <line x1="21" y1="12" x2="9" y2="12"/>
                        </svg>
                    </button>
                </div>
            </div>
        </nav>

        <!-- Preview Area -->
        <div class="preview-area ratio-9-16">
            <!-- Viewport ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€ -->
            <div id="viewport">
                <!-- Stage Ð´Ð»Ñ Ð¼Ð°ÑÑˆÑ‚Ð°Ð±Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ -->
                <div id="stage">
                    <!-- Not Connected State -->
                    <div id="not-connected" class="state-container">
                        <div class="state-card">
                            <h2>Authorization</h2>
                            <p>Visualize your cycling routes and workout data.</p>
                            <button id="connect-strava-btn" class="btn-strava-svg" style="background: none; border: none; padding: 0; cursor: pointer;">
                                <svg width="237" height="48" viewBox="0 0 474 96" fill="none" xmlns="http://www.w3.org/2000/svg" style="display: block;">
                                    <rect width="473.734" height="96" rx="8" fill="white"/>
                                    <path fill-rule="evenodd" clip-rule="evenodd" d="M361.5 63.6396L361.499 63.6381H370.715L376.377 52.254L382.039 63.6381H393.239L376.376 31.0811L360.37 61.9895L354.224 53.016C358.019 51.186 360.384 48.0167 360.384 43.4641V43.3744C360.384 40.1612 359.402 37.8398 357.527 35.9649C355.34 33.7778 351.814 32.3942 346.279 32.3942H331.014V63.6396H341.459V54.7121H343.69L349.582 63.6396H361.5ZM425.91 31.0811L409.05 63.6381H420.25L425.911 52.254L431.573 63.6381H442.773L425.91 31.0811ZM401.153 64.9192L418.014 32.3621H406.814L401.152 43.7462L395.49 32.3621H384.291L401.153 64.9192ZM345.967 47.2579C348.466 47.2579 349.984 46.1421 349.984 44.2228V44.1332C349.984 42.1247 348.421 41.1427 346.012 41.1427H341.459V47.2579H345.967ZM308.677 41.232H299.482V32.3942H328.317V41.232H319.122V63.6396H308.677V41.232ZM274.031 52.3019L268.451 58.9527C272.424 62.4348 278.137 64.2198 284.475 64.2198C292.867 64.2198 298.268 60.2024 298.268 53.6405V53.5516C298.268 47.2579 292.912 44.9366 284.922 43.464C281.619 42.8384 280.771 42.3036 280.771 41.4552V41.3659C280.771 40.6071 281.485 40.0715 283.047 40.0715C285.948 40.0715 289.475 41.0088 292.421 43.1512L297.51 36.0991C293.894 33.2422 289.43 31.8136 283.405 31.8136C274.789 31.8136 270.147 36.4115 270.147 42.3478V42.4375C270.147 49.0432 276.307 51.0525 283.315 52.48C286.663 53.1499 287.644 53.6405 287.644 54.5336V54.6232C287.644 55.4709 286.841 55.9615 284.966 55.9615C281.306 55.9615 277.423 54.891 274.031 52.3019Z" fill="#FC5200"/>
                                    <path d="M235.838 62.3629V42.9248H239.836V50.5071H248.273V42.9248H252.271V62.3629H248.273V54.0362H239.836V62.3629H235.838Z" fill="black"/>
                                    <path d="M221.919 62.3629V46.4264H215.688V42.9248H232.175V46.4264H225.917V62.3629H221.919Z" fill="black"/>
                                    <path d="M208.039 62.3629V42.9248H212.037V62.3629H208.039Z" fill="black"/>
                                    <path d="M184.205 62.3629L179.076 42.9248H183.295L185.5 53.4021C185.776 54.8083 186.024 55.9387 186.272 57.6757H186.383C186.658 56.2144 186.824 55.3045 187.265 53.3745L189.746 42.9248H193.937L196.419 53.3745C196.86 55.3045 197.025 56.2144 197.301 57.6757H197.411C197.66 55.9387 197.908 54.8083 198.183 53.4021L200.417 42.9248H204.608L199.479 62.3629H195.316L192.862 51.9959C192.531 50.5346 192.311 49.5696 191.897 47.5569H191.787C191.373 49.5696 191.153 50.5346 190.822 51.9959L188.368 62.3629H184.205Z" fill="black"/>
                                    <path d="M159.991 62.3629V46.4264H153.76V42.9248H170.248V46.4264H163.989V62.3629H159.991Z" fill="black"/>
                                    <path d="M143.05 62.7765C137.563 62.7765 133.951 58.751 133.951 52.6301C133.951 46.5367 137.563 42.5112 143.05 42.5112C147.379 42.5112 150.632 45.0478 151.156 48.6873L147.158 49.6248C146.717 47.3914 145.173 46.068 142.995 46.068C139.962 46.068 138.059 48.577 138.059 52.6301C138.059 56.6831 139.962 59.2197 142.995 59.2197C145.173 59.2197 146.717 57.8963 147.158 55.6906L151.156 56.628C150.632 60.2675 147.379 62.7765 143.05 62.7765Z" fill="black"/>
                                    <path d="M116.918 62.3629V42.9248H130.401V46.3161H120.916V50.7276H129.711V54.0087H120.916V58.9716H130.401V62.3629H116.918Z" fill="black"/>
                                    <path d="M95.5332 62.3629V42.9248H99.9171L105.845 52.8231C106.755 54.312 107.362 55.5803 108.023 56.9864H108.161L108.078 52.0235V42.9248H111.883V62.3629H107.499L101.544 52.4646C100.662 50.9758 100.055 49.735 99.3657 48.3013H99.2554L99.3381 53.2642V62.3629H95.5332Z" fill="black"/>
                                    <path d="M74.1465 62.3629V42.9248H78.5304L84.4583 52.8231C85.3682 54.312 85.9748 55.5803 86.6365 56.9864H86.7744L86.6917 52.0235V42.9248H90.4966V62.3629H86.1126L80.1571 52.4646C79.2748 50.9758 78.6683 49.735 77.979 48.3013H77.8687L77.9514 53.2642V62.3629H74.1465Z" fill="black"/>
                                    <path d="M60.5825 62.7765C54.9303 62.7765 51.3184 58.6407 51.3184 52.6301C51.3184 46.647 54.9303 42.5112 60.5825 42.5112C66.2347 42.5112 69.8466 46.647 69.8466 52.6301C69.8466 58.6407 66.2347 62.7765 60.5825 62.7765ZM60.5825 59.2197C63.6981 59.2197 65.7384 56.8761 65.7384 52.6301C65.7384 48.384 63.6981 46.068 60.5825 46.068C57.4669 46.068 55.4266 48.384 55.4266 52.6301C55.4266 56.8761 57.4669 59.2197 60.5825 59.2197Z" fill="black"/>
                                    <path d="M39.9737 62.7765C34.4869 62.7765 30.875 58.751 30.875 52.6301C30.875 46.5367 34.4869 42.5112 39.9737 42.5112C44.3025 42.5112 47.5559 45.0478 48.0798 48.6873L44.0819 49.6248C43.6407 47.3914 42.0967 46.068 39.9186 46.068C36.8857 46.068 34.9832 48.577 34.9832 52.6301C34.9832 56.6831 36.8857 59.2197 39.9186 59.2197C42.0967 59.2197 43.6407 57.8963 44.0819 55.6906L48.0798 56.628C47.5559 60.2675 44.3025 62.7765 39.9737 62.7765Z" fill="black"/>
                                </svg>
                            </button>
                        </div>
                        <div class="support-info">
                            <div class="strava-powered">
                                <svg width="128" height="13" viewBox="0 0 365 37" fill="none" xmlns="http://www.w3.org/2000/svg" style="display: block;">
                                    <path d="M0.905029 35.1577H3.31523V29.0503H7.34003C10.8266 29.0503 12.8858 27.1315 12.8858 23.9257C12.8858 20.7433 10.8266 18.7777 7.36343 18.7777H0.905029V35.1577ZM3.31523 26.8039V21.0241H7.26983C9.42263 21.0241 10.4756 21.9601 10.4756 23.9257C10.4756 25.8445 9.39923 26.8039 7.24643 26.8039H3.31523ZM23.6787 35.5087C27.8907 35.5087 30.6753 32.1157 30.6753 26.9677C30.6753 21.8197 27.8907 18.4267 23.6787 18.4267C19.4667 18.4267 16.7055 21.8197 16.7055 26.9677C16.7055 32.1157 19.4667 35.5087 23.6787 35.5087ZM23.6787 33.2623C20.8473 33.2623 19.1157 30.8755 19.1157 26.9677C19.1157 23.0599 20.8473 20.6731 23.6787 20.6731C26.5335 20.6731 28.2651 23.0599 28.2651 26.9677C28.2651 30.8755 26.5335 33.2623 23.6787 33.2623ZM37.4562 35.1577H40.2174L43.9848 22.5919H44.0316L47.7756 35.1577H50.5602L53.6958 18.7777H51.2388L48.8988 31.3201H48.852L45.1314 18.7777H42.8616L39.1644 31.3201H39.1176L36.7776 18.7777H34.2972L37.4562 35.1577ZM58.3356 35.1577H68.3742V32.9113H60.7458V27.8101H67.719V25.6573H60.7458V21.0241H68.3742V18.7777H58.3356V35.1577ZM81.6314 28.5823C84.0416 28.0441 85.469 26.2891 85.469 23.7619C85.469 20.6497 83.3864 18.7777 79.97 18.7777H73.7924V35.1577H76.2026V28.7695H79.0808L82.4504 35.1577H85.1648L81.6314 28.6057V28.5823ZM76.2026 26.5465V21.0241H79.736C81.9356 21.0241 83.0588 21.9367 83.0588 23.7619C83.0588 25.5871 81.9122 26.5465 79.736 26.5465H76.2026ZM90.4832 35.1577H100.522V32.9113H92.8934V27.8101H99.8666V25.6573H92.8934V21.0241H100.522V18.7777H90.4832V35.1577ZM105.94 35.1577H111.111C115.417 35.1577 118.295 32.5369 118.295 26.9443C118.295 21.7963 115.417 18.7777 111.205 18.7777H105.94V35.1577ZM108.35 32.9113V21.0241H111.135C114.036 21.0241 115.885 23.0131 115.885 26.9443C115.885 31.2031 114.036 32.9113 111.018 32.9113H108.35ZM132.055 35.1577H138.115C142 35.1577 144.012 33.4729 144.012 30.2437C144.012 28.3951 143.053 26.9677 141.579 26.3827V26.3359C142.702 25.7743 143.404 24.5809 143.404 23.0599C143.404 20.5093 141.462 18.7777 138.607 18.7777H132.055V35.1577ZM134.465 25.5871V21.0007H138.209C140.034 21.0007 140.994 21.7729 140.994 23.2705C140.994 24.8149 140.081 25.5871 138.209 25.5871H134.465ZM134.465 32.9347V27.6229H138.162C140.572 27.6229 141.602 28.4185 141.602 30.2203C141.602 32.1157 140.549 32.9347 138.115 32.9347H134.465ZM151.963 35.1577H154.373V28.3717L160.012 18.7777H157.321L153.18 26.1253H153.133L148.991 18.7777H146.3L151.963 28.3717V35.1577Z" fill="white"/>
                                    <path fill-rule="evenodd" clip-rule="evenodd" d="M275.925 35.6008L275.923 35.5993H286.002L292.193 23.1514L298.383 35.5993H310.63L292.191 0L274.689 33.7968L267.969 23.9845C272.118 21.9836 274.704 18.5181 274.704 13.54V13.442C274.704 9.92849 273.631 7.39027 271.581 5.34009C269.189 2.94868 265.334 1.43574 259.282 1.43574H242.59V35.6008H254.011V25.8391H256.451L262.893 35.6008H275.925ZM346.353 0L327.917 35.5993H340.164L346.354 23.1514L352.545 35.5993H364.791L346.353 0ZM319.283 37L337.719 1.40071H325.473L319.282 13.8486L313.091 1.40071H300.845L319.283 37ZM258.94 17.6885C261.673 17.6885 263.333 16.4684 263.333 14.3698V14.2718C263.333 12.0756 261.624 11.0019 258.989 11.0019H254.01V17.6885H258.94ZM218.165 11.0994H208.112V1.43574H239.64V11.0994H229.587V35.6008H218.165V11.0994ZM180.282 23.2037L174.181 30.476C178.525 34.2835 184.772 36.2353 191.703 36.2353C200.879 36.2353 206.784 31.8425 206.784 24.6675V24.5703C206.784 17.6885 200.928 15.1502 192.191 13.5401C188.579 12.856 187.652 12.2712 187.652 11.3435V11.2459C187.652 10.4162 188.433 9.83056 190.141 9.83056C193.313 9.83056 197.17 10.8554 200.39 13.1981L205.955 5.48697C202.001 2.36309 197.121 0.800959 190.532 0.800959C181.111 0.800959 176.036 5.8286 176.036 12.3196V12.4176C176.036 19.6406 182.772 21.8376 190.434 23.3986C194.095 24.131 195.168 24.6675 195.168 25.644V25.742C195.168 26.6689 194.29 27.2053 192.24 27.2053C188.238 27.2053 183.992 26.0348 180.282 23.2037Z" fill="white"/>
                                </svg>
                            </div>
                            <div class="support-link">
                                <a href="/information.html">Information Center</a>
                            </div>
                        </div>
                    </div>

                    <!-- Connected State -->
                    <div id="connected" class="connected-state ratio-9-16 hidden">
                        <!-- Preview Canvas -->
                        <canvas id="route-canvas"></canvas>
                        
                        <!-- Stats Overlay -->
                        <div class="stats-overlay">
                            <div class="stat-item">
                                <span class="stat-label">DISTANCE</span>
                                <span class="stat-value" id="distance-value">3 000 m</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">ELEVATION</span>
                                <span class="stat-value" id="elevation-value">3 000 m</span>
                            </div>
                        </div>
                        
                        <!-- Bottom Stats Overlay -->
                        <div class="bottom-stats-overlay">
                            <div class="stat-item">
                                <span class="stat-label">AVG SPEED</span>
                                <span class="stat-value" id="speed-value">15.2 km/h</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">TIME</span>
                                <span class="stat-value" id="time-value">1h 23m</span>
                            </div>
                        </div>
                    </div>

                    <!-- Loading State -->
                    <div id="loading" class="state-container hidden">
                        <div class="state-card">
                            <div class="spinner"></div>
                            <h2>Loading...</h2>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bottom Editing Panel -->
        <div class="editing-panel">
            <!-- Tab Navigation -->
            <div class="tab-nav">
                <button class="tab-btn active" data-tab="photo">PHOTO</button>
                <button class="tab-btn" data-tab="data">DATA</button>
                <button class="tab-btn" data-tab="ratio">RATIO</button>
            </div>

            <!-- Tab Content -->
            <div class="tab-content">
                <!-- Photo Tab -->
                <div id="photo-tab" class="tab-panel active">
                    <button class="action-btn" id="upload-photo-btn">Upload Photo</button>
                    <button class="action-btn" id="mono-toggle-btn" style="display: none; margin-top: 8px;">Convert to Mono</button>
                </div>

                <!-- Data Tab -->
                <div id="data-tab" class="tab-panel">
                    <div class="data-buttons">
                        <button class="data-btn active" data-metric="distance">Distance</button>
                        <button class="data-btn active" data-metric="elevation">Elevation</button>
                        <button class="data-btn active" data-metric="time">Time</button>
                        <button class="data-btn active" data-metric="speed">Speed/Avg</button>
                    </div>
                </div>

                <!-- Ratio Tab -->
                <div id="ratio-tab" class="tab-panel">
                    <div class="ratio-controls">
                        <button class="ratio-btn active" data-ratio="9:16">9:16</button>
                        <button class="ratio-btn" data-ratio="4:5">4:5</button>
                    </div>
                </div>

                <!-- Logo Tab - Hidden -->
                <div id="logo-tab" class="tab-panel" style="display: none;">
                    <button class="action-btn" id="upload-logo-btn">+ Upload Logo</button>
                </div>

                <!-- Position Tab - Hidden -->
                <div id="position-tab" class="tab-panel" style="display: none;">
                    <div class="position-controls">
                        <button class="position-btn" data-position="top-left">Top Left</button>
                        <button class="position-btn" data-position="top-right">Top Right</button>
                        <button class="position-btn" data-position="bottom-left">Bottom Left</button>
                        <button class="position-btn" data-position="bottom-right">Bottom Right</button>
                    </div>
                </div>

                <!-- Ratio Tab -->
                <div id="ratio-tab" class="tab-panel" style="display: none;">
                    <div class="ratio-controls">
                        <button class="ratio-btn active" data-ratio="9:16">9:16</button>
                        <button class="ratio-btn" data-ratio="4:5">4:5</button>
                    </div>
                </div>
            </div>
        </div>
    </div> <!-- Close mobile-container -->

    <!-- Club Selector Modal -->
    <div id="club-selector-modal" class="modal hidden">
        <div class="modal-backdrop"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3>Select Club</h3>
                <div style="display: flex; align-items: center; gap: 16px;">
                    <button class="modal-close" id="close-club-selector">&times;</button>
                </div>
            </div>
            <div class="modal-body">
                <div id="club-list" class="workout-list">
                    <!-- Clubs will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Workout Selector Modal -->
    <div id="workout-selector-modal" class="modal hidden">
        <div class="modal-backdrop"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3>Select Workout</h3>
                <div style="display: flex; align-items: center; gap: 16px;">
                    <a id="strava-link" href="#" target="_blank" rel="noopener noreferrer" class="strava-link" style="display: none;">View on Strava</a>
                    <button class="modal-close" id="close-workout-selector">&times;</button>
                </div>
            </div>
            <div class="modal-body">
                <div id="workout-list" class="workout-list">
                    <!-- Workouts will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Hidden File Inputs -->
    <input type="file" id="photo-input" accept="image/*" style="display: none;">
    <input type="file" id="logo-input" accept="image/*" style="display: none;">

<script src="/route/config.js?v=4"></script>
<script src="/route/polyline.js?v=5"></script>
<script src="/route/addicted-store.js?v=16"></script>
<script src="/route/addicted-canvas-component.js?v=35"></script>
<script src="/route/app-addicted-logic.js?v=26"></script>
    
    <!-- Debug script -->
    <script>
        // Force reset if stuck in loading
        setTimeout(() => {
            const loading = document.getElementById('loading');
            const notConnected = document.getElementById('not-connected');
            if (loading && !loading.classList.contains('hidden') && notConnected) {
                console.log('Force showing not connected state');
                loading.classList.add('hidden');
                notConnected.classList.remove('hidden');
            }
        }, 2000);
        
        // Mobile debug
        console.log('ðŸ“± Mobile debug started');
        console.log('Viewport:', window.innerWidth, 'x', window.innerHeight);
        console.log('User agent:', navigator.userAgent);
        
        // Layout is now handled by CSS with fixed navbar (48px) and editing panel (180px)
        window.addEventListener('load', () => {
            console.log('ðŸ“± Page loaded, layout managed by CSS');
        });
    </script>
</body>
</html>

